# Beer Affiliate Engine - クラフトビールアフィリエイトプラグイン

クラフトビールブログの記事内の地域情報を自動検出し、最適化された旅行アフィリエイトリンクを生成するWordPressプラグインです。rihobeer.comのデザインシステムを採用し、ユーザーフレンドリーな体験と収益最適化を両立します。

![プラグインスクリーンショット](./Images/IMG_0010.png)

## ✨ 主な機能

### 🎯 インテリジェントな地域検出
- **地域名自動検出**: 記事内の国内外の地域名を高精度で検出
- **文脈理解**: ビール関連コンテンツを識別し、関連性の高いリンクのみ生成
- **国内/海外自動判別**: 地域の特性に応じたサービスを自動選択

### 💼 A8.net固定URL機能（NEW）
- **無効リダイレクト防止**: coreda.jpなどの無効なリダイレクトを完全ブロック
- **固定URL使用**: 都市検索を無効化し、設定されたURLをそのまま使用
- **管理画面統合**: 各A8プログラムの固定URLを個別に設定可能

### 🎨 rihobeer.comデザインシステム
- **一貫したブランディング**: サイト全体の視覚的一貫性を保持
- **レスポンシブデザイン**: 全デバイスで最適な表示を実現
- **カスタムカラーパレット**: ブランドカラー (#0095d9, #1e50a2, #3eb370, #ffd900) を使用

### 🔧 高度な設定機能
- **楽天トラベル対応**: 正しいAPI仕様に基づくキーワード検索
- **A8.net完全対応**: 参加中の全プログラムに対応
- **リンク検証システム**: 無効なリンクの表示を防止

## 📋 対応サービス

### 🏠 国内旅行サービス
- **楽天トラベル** (楽天アフィリエイト) - キーワード検索対応
- **JTB国内旅行** (A8.net) - ファミリー旅行特集
- **じゃらんnet** (A8.net) - 宿泊予約
- **一休.comレストラン** (A8.net) - 高級レストラン予約
- **読売旅行** (A8.net) - ツアー予約
- **Yahoo!トラベル** (A8.net) - 宿泊検索
- **Relux** (A8.net) - 高級ホテル・旅館

### ✈️ 海外旅行サービス
- **トラベル・スタンダード・ジャパン** (A8.net) - オーダーメイド海外旅行
- **Travelist** (A8.net) - 格安航空券
- **カタール航空** (A8.net) - 国際線航空券
- **JAL日本航空** (A8.net) - 国際線航空券
- **ANA全日空** (A8.net) - 航空券予約
- **Oooh(ウー)** (A8.net) - 現地オプショナルツアー

### 📱 旅行関連サービス
- **Saily** (A8.net) - 海外旅行用eSIM
- **海外Wi-FiレンタルのFAST-Fi** (A8.net) - WiFiレンタル
- **日産レンタカー** (A8.net) - レンタカー予約

### 🛒 ショッピング
- **JTBショッピング** (A8.net) - 名産品・お土産
- **Otomoni** (A8.net) - クラフトビール定期便

## 対応地域

- **国内**: 東京、大阪、京都、福岡、札幌、横浜、名古屋、仙台、那覇、広島、金沢 など
- **海外**: シアトル、ポートランド、ロサンゼルス、サンディエゴ、ニューヨーク、バンクーバー、ミュンヘン、ブリュッセル、プラハ など

## 動作要件

- WordPress 5.6以上
- PHP 7.2以上
- PHP拡張機能: `json`, `mbstring`

## インストール方法

### 自動インストール
1. WordPress管理画面から「プラグイン」→「新規追加」を選択
2. 「プラグインのアップロード」をクリック
3. このプラグインのZIPファイルを選択してアップロード
4. 「今すぐインストール」をクリック
5. インストール完了後、「プラグインを有効化」をクリック

### 手動インストール
1. このプラグインのZIPファイルをダウンロードして解凍
2. `beer-affiliate-engine`フォルダをサーバーの`/wp-content/plugins/`ディレクトリにアップロード
3. WordPress管理画面から「プラグイン」を開き、「クラフトビールアフィリエイト自動最適化プラグイン」を有効化

## ⚙️ 設定方法

### 基本設定
1. WordPress管理画面から「Beer Affiliate」を選択
2. 「アフィリエイト設定」で以下を設定：

#### 楽天アフィリエイト設定
- **アフィリエイトID**: 楽天アフィリエイト管理画面から取得
- **アプリケーションID**: 楽天ウェブサービスから取得

#### A8.net設定
- **メディアID**: A8.net管理画面から取得
- **A8固定URL設定**: 各プログラムの固定URLを個別設定

#### 表示設定
- **デフォルトテンプレート**: ユーザーフレンドリー（推奨）/カード/ボタン
- **最大リンク数**: 記事あたりの表示リンク数（1-10）
- **収益最適化モード**: 高収益プログラムを優先表示

### A8.net固定URL設定の重要性
固定URL機能により以下の問題を解決：
- ❌ 無効なリダイレクト（coreda.jpなど）を防止
- ✅ 確実にアフィリエイト報酬が発生するURLのみ使用
- ✅ 都市検索による不具合を回避

## 使用方法

### 自動挿入
設定で「記事末尾に自動挿入」を有効にしている場合、地域名を含む記事の末尾に自動的にアフィリエイトリンクが挿入されます。

### ショートコード
任意の位置にアフィリエイトリンクを表示するには、以下のショートコードを使用します：

```
[beer_affiliate]
```

ショートコードに引数を指定することも可能です：

```
[beer_affiliate template="card" max_links="2"]
```

**引数**:
- `template`: 表示テンプレート (`card`, `button`, `sticky`)
- `max_links`: 最大表示リンク数 (1-5)

## 画像のカスタマイズ

地域やサービスの画像をカスタマイズする場合は、以下のディレクトリに画像ファイルを配置します：

```
/wp-content/plugins/beer-affiliate-engine/modules/travel/images/
```

### 地域画像ファイル名
国内: `tokyo.jpg`, `osaka.jpg`, `kyoto.jpg` など  
海外: `seattle.jpg`, `los_angeles.jpg`, `new_york.jpg` など

### サービスロゴファイル名
`rakuten.png`, `jtb.png`, `his.png`, `travel-standard.png`, `travelist.png` など

## トラブルシューティング

### リンクが表示されない
- 記事内に地域名が正確に含まれているか確認
- カスタマイザー設定で「記事末尾に自動挿入」が有効になっているか確認
- ショートコードが正しく配置されているか確認

### 画像が表示されない
- 画像ファイルが正しいパスに配置されているか確認
- 画像ファイル名が正しいか確認
- 画像の権限が適切に設定されているか確認

### 国際リンクが表示されない
- カスタマイザー設定で「海外都市への対応を有効化」が有効になっているか確認
- 記事内の海外都市名が地域辞書に含まれているか確認

## 開発者向け情報

### プラグイン拡張
このプラグインは拡張性を考慮した設計になっています。新しいモジュールの追加、表示テンプレートのカスタマイズ、新しいアフィリエイトサービスの追加などが容易に行えます。

詳細な開発者向け情報は以下のファイルを参照してください：
- `docs/code-convention.md`: コード規約と設計情報
- `docs/implementation-guide.md`: 実装ガイド

### 地域の追加
`modules/travel/city-dictionary.json` ファイルに地域情報を追加することで、新しい地域に対応できます。

### アフィリエイトサービスの追加
`modules/travel/link-templates.json` ファイルに新しいサービス情報を追加することで、アフィリエイトサービスを拡張できます。

## ライセンス

GPL v2 または以降

## 開発者

[RihoBeer](https://rihobeer.com/)

## 🚀 パフォーマンス最適化

### 高速化技術
- **インテリジェントキャッシュ**: テンプレートとデータの効率的なキャッシュシステム
- **遅延読み込み**: 必要な時のみモジュールを読み込む設計
- **最小限DOM操作**: ページ表示速度への影響を最小化

### SEO対策
- **構造化データ**: 検索エンジン最適化されたHTMLマークアップ
- **アクセシビリティ**: WAI-ARIAガイドライン準拠
- **モバイルファースト**: 全デバイスでの最適な表示

## 🔧 トラブルシューティング

### よくある問題と解決法

**Q: A8.netリンクがcoreda.jpにリダイレクトされる**
A: 「A8固定URL設定」で各プログラムの正しいURLを設定してください。

**Q: 楽天トラベルリンクが404エラーになる**
A: アフィリエイトIDが正しく設定されているか確認してください。

**Q: リンクが表示されない**
A: 記事内にビール関連キーワードと地域名の両方が含まれているか確認してください。

**Q: デザインがサイトに合わない**
A: rihobeer.comデザインシステムを使用しており、CSSでカスタマイズ可能です。

## 📊 変更履歴

### 1.3.0 (2025-01-08) - 現在のバージョン
#### 🆕 新機能
- **A8.net固定URL機能**: 無効リダイレクトを完全ブロック
- **管理画面統合**: 各A8プログラムのURL個別設定
- **rihobeer.comデザインシステム**: 統一されたブランドデザイン
- **楽天トラベルAPI修正**: 正しいエンドポイントへの変更

#### 🔧 改善
- リンク検証システムの強化
- 表示ラベルの最適化（都市名除去）
- レスポンシブデザインの改善
- パフォーマンス最適化

#### 🐛 修正
- coreda.jpへの無効リダイレクト問題
- 楽天トラベル404エラー
- モバイル表示の不具合
- アフィリエイトID設定の問題

### 1.0.0 (2025-04-03)
- 初回リリース
- 基本的なアフィリエイトリンク生成機能
