# クラフトビールアフィリエイト自動最適化プラグイン
クラフトビールブログ rihobeer.com の記事内の地域情報を自動検出し、対応する旅行アフィリエイト広告を記事下部に表示するWordPressプラグインです。国内・海外の地域に対応し、複数のアフィリエイトサービスに自動で連携します。

![理想のバランスと現在の状況](./images/IMG_0010.png)
![理想のバランスと現在の状況](./images/IMG_0011.png)
![理想のバランスと現在の状況](./images/IMG_0012.png)
![理想のバランスと現在の状況](./images/IMG_0014.png)
## 主な機能

- **地域名自動検出**: 記事内の国内外の地域名を自動検出
- **アフィリエイトリンク自動生成**: 検出した地域に最適な旅行アフィリエイトリンクを自動生成
- **国内/海外の自動判別**: 地域に応じて国内旅行サービスと海外旅行サービスを適切に表示
- **複数表示形式**: カード表示、ボタン表示、スクロール追従表示に対応
- **カテゴリーフィルタリング**: 旅行系と買い物系のリンクを選択的に表示
- **楽天アフィリエイト対応**: 楽天トラベルのアフィリエイトリンクを生成
- **A8.net対応**: JTB、HIS、Travelist、カタール航空など多数のA8.netサービスと連携
- **拡張可能な設計**: 将来的な機能拡張やカテゴリー追加が容易な設計

## 対応サービス

### 国内旅行アフィリエイト
- 楽天トラベル
- JTB国内旅行
- HIS

### 海外旅行アフィリエイト
- トラベル・スタンダード・ジャパン
- Travelist（海外格安航空券）
- カタール航空
- Oooh（ウー）- 現地オプショナルツアー
- Saily - 海外旅行用eSIM

### 買い物系アフィリエイト
- JTBショッピング

## 対応地域

- **国内**: 東京、大阪、京都、福岡、札幌、横浜、名古屋、仙台、那覇、広島、金沢 など
- **海外**: シアトル、ポートランド、ロサンゼルス、サンディエゴ、ニューヨーク、バンクーバー、ミュンヘン、ブリュッセル、プラハ など

## 動作要件

- WordPress 5.6以上
- PHP 7.2以上
- PHP拡張機能: `json`, `mbstring`

## インストール方法

### 自動インストール
1. WordPress管理画面から「プラグイン」→「新規追加」を選択
2. 「プラグインのアップロード」をクリック
3. このプラグインのZIPファイルを選択してアップロード
4. 「今すぐインストール」をクリック
5. インストール完了後、「プラグインを有効化」をクリック

### 手動インストール
1. このプラグインのZIPファイルをダウンロードして解凍
2. `beer-affiliate-engine`フォルダをサーバーの`/wp-content/plugins/`ディレクトリにアップロード
3. WordPress管理画面から「プラグイン」を開き、「クラフトビールアフィリエイト自動最適化プラグイン」を有効化

## 設定方法

1. WordPress管理画面から「外観」→「カスタマイズ」を選択
2. 「ビールアフィリエイト設定」セクションを開く
3. 以下の設定を行う：
   - **表示テンプレート**: カード表示、ボタン表示、スクロール追従表示から選択
   - **記事末尾に自動挿入**: 有効/無効
   - **最大表示リンク数**: 1〜5の間で設定
   - **海外都市への対応を有効化**: 有効/無効
   - **優先国際旅行サービス**: 優先的に表示するサービスを選択
   - **表示するリンクカテゴリー**: 旅行のみ/買い物のみ/すべて表示
4. 「公開」ボタンをクリックして設定を保存

## 使用方法

### 自動挿入
設定で「記事末尾に自動挿入」を有効にしている場合、地域名を含む記事の末尾に自動的にアフィリエイトリンクが挿入されます。

### ショートコード
任意の位置にアフィリエイトリンクを表示するには、以下のショートコードを使用します：

```
[beer_affiliate]
```

ショートコードに引数を指定することも可能です：

```
[beer_affiliate template="card" max_links="2"]
```

**引数**:
- `template`: 表示テンプレート (`card`, `button`, `sticky`)
- `max_links`: 最大表示リンク数 (1-5)

## 画像のカスタマイズ

地域やサービスの画像をカスタマイズする場合は、以下のディレクトリに画像ファイルを配置します：

```
/wp-content/plugins/beer-affiliate-engine/modules/travel/images/
```

### 地域画像ファイル名
国内: `tokyo.jpg`, `osaka.jpg`, `kyoto.jpg` など  
海外: `seattle.jpg`, `los_angeles.jpg`, `new_york.jpg` など

### サービスロゴファイル名
`rakuten.png`, `jtb.png`, `his.png`, `travel-standard.png`, `travelist.png` など

## トラブルシューティング

### リンクが表示されない
- 記事内に地域名が正確に含まれているか確認
- カスタマイザー設定で「記事末尾に自動挿入」が有効になっているか確認
- ショートコードが正しく配置されているか確認

### 画像が表示されない
- 画像ファイルが正しいパスに配置されているか確認
- 画像ファイル名が正しいか確認
- 画像の権限が適切に設定されているか確認

### 国際リンクが表示されない
- カスタマイザー設定で「海外都市への対応を有効化」が有効になっているか確認
- 記事内の海外都市名が地域辞書に含まれているか確認

## 開発者向け情報

### プラグイン拡張
このプラグインは拡張性を考慮した設計になっています。新しいモジュールの追加、表示テンプレートのカスタマイズ、新しいアフィリエイトサービスの追加などが容易に行えます。

詳細な開発者向け情報は以下のファイルを参照してください：
- `docs/code-convention.md`: コード規約と設計情報
- `docs/implementation-guide.md`: 実装ガイド

### 地域の追加
`modules/travel/city-dictionary.json` ファイルに地域情報を追加することで、新しい地域に対応できます。

### アフィリエイトサービスの追加
`modules/travel/link-templates.json` ファイルに新しいサービス情報を追加することで、アフィリエイトサービスを拡張できます。

## ライセンス

GPL v2 または以降

## 開発者

[RihoBeer](https://rihobeer.com/)

## 変更履歴

### 1.0.0 (2025-04-03)
- 初回リリース
- 楽天トラベルとA8.netアフィリエイト対応
- 国内外の地域対応機能
- 複数表示テンプレート対応
